#!/bin/bash

declare -A prefix_emoji=(
  ["init"]="ðŸŽ‰"

  ["fix"]="ðŸ›"
  ["add"]="âœ¨"
  ["feature"]="âœ¨"
  ["remove"]="ðŸ”¥"
  ["update"]="ðŸ”ƒ"

  ["alog"]="ðŸ”Š"
  ["dlog"]="ðŸ”‡"
  ["debug"]="ðŸ”"
  ["refactor"]="â™»ï¸"
  ["docs"]="ðŸ“š"
  ["test"]="ðŸ§ª"
  ["wip"]="ðŸš§"
  ["gitignore"]="ðŸ™ˆ"
  ["settings"]="ðŸ”§"
  ["format"]="ðŸŽ¨"

  ["merge"]="ðŸ”€"
  ["revert"]="âªï¸"
)

commit_msg_file="$1"
commit_msg_msg=$(cat "$commit_msg_file")

prefix_found=false
for prefix in "${!prefix_emoji[@]}"; do
  if [[ "$commit_msg_msg" == "${prefix}"* ]]; then
    prefix_found=true
    if [[ "$commit_msg_msg" == "alogs"* ]]; then
      prefix_msg="add logs"
    elif [[ "$commit_msg_msg" == "dlogs"* ]]; then
      prefix_msg="remove logs"
    fi
    break
  fi
done

if ! $prefix_found; then
  prefix="update"
fi

if [[ -z "$prefix_msg" ]]; then
  prefix_msg=$prefix
fi

commit_desc=${commit_msg_msg#"${prefix}" }
new_commit_msg="${prefix_emoji[${prefix}]} $prefix_msg: $commit_desc"

# echo -e "ï• $new_commit_msg"
echo -e "$new_commit_msg" >"$commit_msg_file"

